2021-06-16 12:59:02,268 - Discovery - Open Intent Discovery Begin...
2021-06-16 12:59:02,268 - Discovery - Parameters Initialization...
2021-06-16 12:59:02,268 - Discovery - ============================== Params ==============================
2021-06-16 12:59:02,268 - Discovery - type:	open_intent_detection
2021-06-16 12:59:02,268 - Discovery - dataset:	banking
2021-06-16 12:59:02,268 - Discovery - known_cls_ratio:	0.75
2021-06-16 12:59:02,268 - Discovery - labeled_ratio:	0.1
2021-06-16 12:59:02,269 - Discovery - cluster_num_factor:	1
2021-06-16 12:59:02,269 - Discovery - method:	DeepAligned
2021-06-16 12:59:02,269 - Discovery - train:	True
2021-06-16 12:59:02,269 - Discovery - save_model:	False
2021-06-16 12:59:02,269 - Discovery - backbone:	bert
2021-06-16 12:59:02,269 - Discovery - num_train_epochs:	100
2021-06-16 12:59:02,269 - Discovery - setting:	semi_supervised
2021-06-16 12:59:02,269 - Discovery - config_file_name:	DeepAligned
2021-06-16 12:59:02,269 - Discovery - seed:	0
2021-06-16 12:59:02,269 - Discovery - gpu_id:	1
2021-06-16 12:59:02,269 - Discovery - pipe_results_path:	pipe_results
2021-06-16 12:59:02,269 - Discovery - data_dir:	/home/zhanghanlei/git/TEXTOIR/open_intent_discovery/../data
2021-06-16 12:59:02,269 - Discovery - output_dir:	outputs
2021-06-16 12:59:02,269 - Discovery - model_dir:	models
2021-06-16 12:59:02,269 - Discovery - result_dir:	results
2021-06-16 12:59:02,269 - Discovery - results_file_name:	results.csv
2021-06-16 12:59:02,269 - Discovery - save_results:	False
2021-06-16 12:59:02,269 - Discovery - method_output_dir:	outputs/open_intent_detection/DeepAligned_banking_0.75_0.1_bert
2021-06-16 12:59:02,269 - Discovery - model_output_dir:	outputs/open_intent_detection/DeepAligned_banking_0.75_0.1_bert/models
2021-06-16 12:59:02,269 - Discovery - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2021-06-16 12:59:02,269 - Discovery - max_seq_length:	None
2021-06-16 12:59:02,269 - Discovery - freeze_bert_parameters:	True
2021-06-16 12:59:02,269 - Discovery - feat_dim:	768
2021-06-16 12:59:02,269 - Discovery - warmup_proportion:	0.1
2021-06-16 12:59:02,269 - Discovery - lr_pre:	5e-05
2021-06-16 12:59:02,269 - Discovery - lr:	5e-05
2021-06-16 12:59:02,269 - Discovery - loss_fct:	CrossEntropyLoss
2021-06-16 12:59:02,269 - Discovery - train_batch_size:	128
2021-06-16 12:59:02,269 - Discovery - eval_batch_size:	128
2021-06-16 12:59:02,269 - Discovery - test_batch_size:	128
2021-06-16 12:59:02,269 - Discovery - wait_patient:	20
2021-06-16 12:59:02,269 - Discovery - ============================== End Params ==============================
2021-06-16 12:59:02,269 - Discovery - Data and Model Preparation...
2021-06-16 12:59:02,994 - Discovery - Number of labeled samples = 673
2021-06-16 12:59:02,995 - Discovery - Number of unlabeled samples = 8330
2021-06-16 12:59:09,825 - Discovery - Pre-raining start...
2021-06-16 12:59:13,575 - Discovery - ***** Epoch: 1: Eval results *****
2021-06-16 12:59:13,575 - Discovery -   best_acc = 0
2021-06-16 12:59:13,575 - Discovery -   eval_acc = 0.020080321285140562
2021-06-16 12:59:13,575 - Discovery -   train_loss = 4.061360120773315
2021-06-16 12:59:14,579 - Discovery - ***** Epoch: 2: Eval results *****
2021-06-16 12:59:14,579 - Discovery -   best_acc = 0.020080321285140562
2021-06-16 12:59:14,579 - Discovery -   eval_acc = 0.022757697456492636
2021-06-16 12:59:14,579 - Discovery -   train_loss = 4.054033676783244
2021-06-16 12:59:15,587 - Discovery - ***** Epoch: 3: Eval results *****
2021-06-16 12:59:15,587 - Discovery -   best_acc = 0.022757697456492636
2021-06-16 12:59:15,587 - Discovery -   eval_acc = 0.06157965194109773
2021-06-16 12:59:15,587 - Discovery -   train_loss = 4.026773691177368
2021-06-16 12:59:16,595 - Discovery - ***** Epoch: 4: Eval results *****
2021-06-16 12:59:16,595 - Discovery -   best_acc = 0.06157965194109773
2021-06-16 12:59:16,595 - Discovery -   eval_acc = 0.11914323962516733
2021-06-16 12:59:16,595 - Discovery -   train_loss = 3.9872167110443115
2021-06-16 12:59:17,610 - Discovery - ***** Epoch: 5: Eval results *****
2021-06-16 12:59:17,610 - Discovery -   best_acc = 0.11914323962516733
2021-06-16 12:59:17,610 - Discovery -   eval_acc = 0.18741633199464525
2021-06-16 12:59:17,610 - Discovery -   train_loss = 3.9210031032562256
2021-06-16 12:59:18,624 - Discovery - ***** Epoch: 6: Eval results *****
2021-06-16 12:59:18,624 - Discovery -   best_acc = 0.18741633199464525
2021-06-16 12:59:18,626 - Discovery -   eval_acc = 0.2463186077643909
2021-06-16 12:59:18,626 - Discovery -   train_loss = 3.748544534047445
2021-06-16 12:59:19,637 - Discovery - ***** Epoch: 7: Eval results *****
2021-06-16 12:59:19,637 - Discovery -   best_acc = 0.2463186077643909
2021-06-16 12:59:19,637 - Discovery -   eval_acc = 0.2677376171352075
2021-06-16 12:59:19,637 - Discovery -   train_loss = 3.4810948769251504
2021-06-16 12:59:20,649 - Discovery - ***** Epoch: 8: Eval results *****
2021-06-16 12:59:20,649 - Discovery -   best_acc = 0.2677376171352075
2021-06-16 12:59:20,649 - Discovery -   eval_acc = 0.37215528781793844
2021-06-16 12:59:20,649 - Discovery -   train_loss = 3.04338006178538
2021-06-16 12:59:21,661 - Discovery - ***** Epoch: 9: Eval results *****
2021-06-16 12:59:21,661 - Discovery -   best_acc = 0.37215528781793844
2021-06-16 12:59:21,661 - Discovery -   eval_acc = 0.5194109772423026
2021-06-16 12:59:21,661 - Discovery -   train_loss = 2.570309599240621
2021-06-16 12:59:22,674 - Discovery - ***** Epoch: 10: Eval results *****
2021-06-16 12:59:22,674 - Discovery -   best_acc = 0.5194109772423026
2021-06-16 12:59:22,674 - Discovery -   eval_acc = 0.5876840696117804
2021-06-16 12:59:22,674 - Discovery -   train_loss = 2.0968857407569885
2021-06-16 12:59:23,690 - Discovery - ***** Epoch: 11: Eval results *****
2021-06-16 12:59:23,691 - Discovery -   best_acc = 0.5876840696117804
2021-06-16 12:59:23,691 - Discovery -   eval_acc = 0.6479250334672021
2021-06-16 12:59:23,691 - Discovery -   train_loss = 1.6211124062538147
2021-06-16 12:59:24,706 - Discovery - ***** Epoch: 12: Eval results *****
2021-06-16 12:59:24,706 - Discovery -   best_acc = 0.6479250334672021
2021-06-16 12:59:24,706 - Discovery -   eval_acc = 0.6760374832663989
2021-06-16 12:59:24,706 - Discovery -   train_loss = 1.2588993112246196
2021-06-16 12:59:25,781 - Discovery - ***** Epoch: 13: Eval results *****
2021-06-16 12:59:25,781 - Discovery -   best_acc = 0.6760374832663989
2021-06-16 12:59:25,781 - Discovery -   eval_acc = 0.7108433734939759
2021-06-16 12:59:25,781 - Discovery -   train_loss = 0.9971977372964224
2021-06-16 12:59:26,803 - Discovery - ***** Epoch: 14: Eval results *****
2021-06-16 12:59:26,803 - Discovery -   best_acc = 0.7108433734939759
2021-06-16 12:59:26,803 - Discovery -   eval_acc = 0.7402945113788487
2021-06-16 12:59:26,803 - Discovery -   train_loss = 0.8106455306212107
2021-06-16 12:59:27,820 - Discovery - ***** Epoch: 15: Eval results *****
2021-06-16 12:59:27,820 - Discovery -   best_acc = 0.7402945113788487
2021-06-16 12:59:27,820 - Discovery -   eval_acc = 0.7657295850066934
2021-06-16 12:59:27,820 - Discovery -   train_loss = 0.6145658294359843
2021-06-16 12:59:28,837 - Discovery - ***** Epoch: 16: Eval results *****
2021-06-16 12:59:28,837 - Discovery -   best_acc = 0.7657295850066934
2021-06-16 12:59:28,837 - Discovery -   eval_acc = 0.7630522088353414
2021-06-16 12:59:28,837 - Discovery -   train_loss = 0.5059535304705302
2021-06-16 12:59:29,845 - Discovery - ***** Epoch: 17: Eval results *****
2021-06-16 12:59:29,845 - Discovery -   best_acc = 0.7657295850066934
2021-06-16 12:59:29,845 - Discovery -   eval_acc = 0.7684069611780455
2021-06-16 12:59:29,845 - Discovery -   train_loss = 0.39474689960479736
2021-06-16 12:59:30,864 - Discovery - ***** Epoch: 18: Eval results *****
2021-06-16 12:59:30,864 - Discovery -   best_acc = 0.7684069611780455
2021-06-16 12:59:30,864 - Discovery -   eval_acc = 0.7751004016064257
2021-06-16 12:59:30,864 - Discovery -   train_loss = 0.3351532767216365
2021-06-16 12:59:31,883 - Discovery - ***** Epoch: 19: Eval results *****
2021-06-16 12:59:31,884 - Discovery -   best_acc = 0.7751004016064257
2021-06-16 12:59:31,884 - Discovery -   eval_acc = 0.8032128514056225
2021-06-16 12:59:31,884 - Discovery -   train_loss = 0.261542742451032
2021-06-16 12:59:32,901 - Discovery - ***** Epoch: 20: Eval results *****
2021-06-16 12:59:32,901 - Discovery -   best_acc = 0.8032128514056225
2021-06-16 12:59:32,902 - Discovery -   eval_acc = 0.7898259705488622
2021-06-16 12:59:32,902 - Discovery -   train_loss = 0.2166908954580625
2021-06-16 12:59:33,908 - Discovery - ***** Epoch: 21: Eval results *****
2021-06-16 12:59:33,908 - Discovery -   best_acc = 0.8032128514056225
2021-06-16 12:59:33,910 - Discovery -   eval_acc = 0.8058902275769746
2021-06-16 12:59:33,910 - Discovery -   train_loss = 0.18374711523453394
2021-06-16 12:59:34,933 - Discovery - ***** Epoch: 22: Eval results *****
2021-06-16 12:59:34,933 - Discovery -   best_acc = 0.8058902275769746
2021-06-16 12:59:34,933 - Discovery -   eval_acc = 0.8018741633199464
2021-06-16 12:59:34,933 - Discovery -   train_loss = 0.15595672527949014
2021-06-16 12:59:35,941 - Discovery - ***** Epoch: 23: Eval results *****
2021-06-16 12:59:35,942 - Discovery -   best_acc = 0.8058902275769746
2021-06-16 12:59:35,942 - Discovery -   eval_acc = 0.8099062918340026
2021-06-16 12:59:35,942 - Discovery -   train_loss = 0.13917663196722665
2021-06-16 12:59:36,961 - Discovery - ***** Epoch: 24: Eval results *****
2021-06-16 12:59:36,961 - Discovery -   best_acc = 0.8099062918340026
2021-06-16 12:59:36,961 - Discovery -   eval_acc = 0.8112449799196787
2021-06-16 12:59:36,961 - Discovery -   train_loss = 0.12845294053355852
2021-06-16 12:59:37,980 - Discovery - ***** Epoch: 25: Eval results *****
2021-06-16 12:59:37,980 - Discovery -   best_acc = 0.8112449799196787
2021-06-16 12:59:37,980 - Discovery -   eval_acc = 0.8099062918340026
2021-06-16 12:59:37,980 - Discovery -   train_loss = 0.10671088223656018
2021-06-16 12:59:38,999 - Discovery - ***** Epoch: 26: Eval results *****
2021-06-16 12:59:38,999 - Discovery -   best_acc = 0.8112449799196787
2021-06-16 12:59:38,999 - Discovery -   eval_acc = 0.8179384203480589
2021-06-16 12:59:38,999 - Discovery -   train_loss = 0.09435130407412846
2021-06-16 12:59:40,023 - Discovery - ***** Epoch: 27: Eval results *****
2021-06-16 12:59:40,023 - Discovery -   best_acc = 0.8179384203480589
2021-06-16 12:59:40,023 - Discovery -   eval_acc = 0.8139223560910308
2021-06-16 12:59:40,023 - Discovery -   train_loss = 0.0833057810862859
2021-06-16 12:59:41,035 - Discovery - ***** Epoch: 28: Eval results *****
2021-06-16 12:59:41,035 - Discovery -   best_acc = 0.8179384203480589
2021-06-16 12:59:41,035 - Discovery -   eval_acc = 0.8179384203480589
2021-06-16 12:59:41,035 - Discovery -   train_loss = 0.07408957245449226
2021-06-16 12:59:42,047 - Discovery - ***** Epoch: 29: Eval results *****
2021-06-16 12:59:42,047 - Discovery -   best_acc = 0.8179384203480589
2021-06-16 12:59:42,047 - Discovery -   eval_acc = 0.8152610441767069
2021-06-16 12:59:42,047 - Discovery -   train_loss = 0.0737124929825465
2021-06-16 12:59:43,060 - Discovery - ***** Epoch: 30: Eval results *****
2021-06-16 12:59:43,060 - Discovery -   best_acc = 0.8179384203480589
2021-06-16 12:59:43,060 - Discovery -   eval_acc = 0.820615796519411
2021-06-16 12:59:43,060 - Discovery -   train_loss = 0.06467123391727607
2021-06-16 12:59:44,085 - Discovery - ***** Epoch: 31: Eval results *****
2021-06-16 12:59:44,085 - Discovery -   best_acc = 0.820615796519411
2021-06-16 12:59:44,085 - Discovery -   eval_acc = 0.8099062918340026
2021-06-16 12:59:44,085 - Discovery -   train_loss = 0.06517486833035946
2021-06-16 12:59:45,096 - Discovery - ***** Epoch: 32: Eval results *****
2021-06-16 12:59:45,096 - Discovery -   best_acc = 0.820615796519411
2021-06-16 12:59:45,096 - Discovery -   eval_acc = 0.8112449799196787
2021-06-16 12:59:45,096 - Discovery -   train_loss = 0.06019402667880058
2021-06-16 12:59:46,110 - Discovery - ***** Epoch: 33: Eval results *****
2021-06-16 12:59:46,111 - Discovery -   best_acc = 0.820615796519411
2021-06-16 12:59:46,111 - Discovery -   eval_acc = 0.8192771084337349
2021-06-16 12:59:46,111 - Discovery -   train_loss = 0.05527324974536896
2021-06-16 12:59:47,123 - Discovery - ***** Epoch: 34: Eval results *****
2021-06-16 12:59:47,123 - Discovery -   best_acc = 0.820615796519411
2021-06-16 12:59:47,123 - Discovery -   eval_acc = 0.8099062918340026
2021-06-16 12:59:47,123 - Discovery -   train_loss = 0.051074509198466934
2021-06-16 12:59:48,138 - Discovery - ***** Epoch: 35: Eval results *****
2021-06-16 12:59:48,138 - Discovery -   best_acc = 0.820615796519411
2021-06-16 12:59:48,138 - Discovery -   eval_acc = 0.8099062918340026
2021-06-16 12:59:48,138 - Discovery -   train_loss = 0.04628476562599341
