2021-06-16 13:05:40,631 - Discovery - Open Intent Discovery Begin...
2021-06-16 13:05:40,631 - Discovery - Parameters Initialization...
2021-06-16 13:05:40,632 - Discovery - ============================== Params ==============================
2021-06-16 13:05:40,632 - Discovery - type:	open_intent_detection
2021-06-16 13:05:40,632 - Discovery - dataset:	banking
2021-06-16 13:05:40,632 - Discovery - known_cls_ratio:	0.75
2021-06-16 13:05:40,632 - Discovery - labeled_ratio:	0.1
2021-06-16 13:05:40,632 - Discovery - cluster_num_factor:	1
2021-06-16 13:05:40,632 - Discovery - method:	DeepAligned
2021-06-16 13:05:40,632 - Discovery - train:	True
2021-06-16 13:05:40,632 - Discovery - save_model:	False
2021-06-16 13:05:40,632 - Discovery - backbone:	bert
2021-06-16 13:05:40,632 - Discovery - num_train_epochs:	100
2021-06-16 13:05:40,632 - Discovery - setting:	semi_supervised
2021-06-16 13:05:40,632 - Discovery - config_file_name:	DeepAligned
2021-06-16 13:05:40,632 - Discovery - seed:	0
2021-06-16 13:05:40,632 - Discovery - gpu_id:	1
2021-06-16 13:05:40,632 - Discovery - pipe_results_path:	pipe_results
2021-06-16 13:05:40,632 - Discovery - data_dir:	/home/zhanghanlei/git/TEXTOIR/open_intent_discovery/../data
2021-06-16 13:05:40,632 - Discovery - output_dir:	outputs
2021-06-16 13:05:40,632 - Discovery - model_dir:	models
2021-06-16 13:05:40,632 - Discovery - result_dir:	results
2021-06-16 13:05:40,632 - Discovery - results_file_name:	results.csv
2021-06-16 13:05:40,632 - Discovery - save_results:	False
2021-06-16 13:05:40,632 - Discovery - method_output_dir:	outputs/open_intent_detection/DeepAligned_banking_0.75_0.1_bert
2021-06-16 13:05:40,632 - Discovery - model_output_dir:	outputs/open_intent_detection/DeepAligned_banking_0.75_0.1_bert/models
2021-06-16 13:05:40,632 - Discovery - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2021-06-16 13:05:40,632 - Discovery - max_seq_length:	None
2021-06-16 13:05:40,632 - Discovery - freeze_bert_parameters:	True
2021-06-16 13:05:40,632 - Discovery - feat_dim:	768
2021-06-16 13:05:40,632 - Discovery - warmup_proportion:	0.1
2021-06-16 13:05:40,632 - Discovery - lr_pre:	5e-05
2021-06-16 13:05:40,632 - Discovery - lr:	5e-05
2021-06-16 13:05:40,632 - Discovery - loss_fct:	CrossEntropyLoss
2021-06-16 13:05:40,632 - Discovery - train_batch_size:	128
2021-06-16 13:05:40,632 - Discovery - eval_batch_size:	128
2021-06-16 13:05:40,632 - Discovery - test_batch_size:	128
2021-06-16 13:05:40,632 - Discovery - wait_patient:	20
2021-06-16 13:05:40,632 - Discovery - ============================== End Params ==============================
2021-06-16 13:05:40,632 - Discovery - Data and Model Preparation...
2021-06-16 13:05:41,348 - Discovery - Number of labeled samples = 673
2021-06-16 13:05:41,349 - Discovery - Number of unlabeled samples = 8330
2021-06-16 13:05:48,148 - Discovery - Pre-raining start...
2021-06-16 13:05:51,895 - Discovery - ***** Epoch: 1: Eval results *****
2021-06-16 13:05:51,895 - Discovery -   best_acc = 0
2021-06-16 13:05:51,895 - Discovery -   eval_acc = 0.020080321285140562
2021-06-16 13:05:51,895 - Discovery -   train_loss = 4.066388289133708
2021-06-16 13:05:52,899 - Discovery - ***** Epoch: 2: Eval results *****
2021-06-16 13:05:52,899 - Discovery -   best_acc = 0.020080321285140562
2021-06-16 13:05:52,899 - Discovery -   eval_acc = 0.02677376171352075
2021-06-16 13:05:52,899 - Discovery -   train_loss = 4.0482776165008545
2021-06-16 13:05:53,906 - Discovery - ***** Epoch: 3: Eval results *****
2021-06-16 13:05:53,907 - Discovery -   best_acc = 0.02677376171352075
2021-06-16 13:05:53,907 - Discovery -   eval_acc = 0.04417670682730924
2021-06-16 13:05:53,907 - Discovery -   train_loss = 4.003247181574504
2021-06-16 13:05:54,913 - Discovery - ***** Epoch: 4: Eval results *****
2021-06-16 13:05:54,913 - Discovery -   best_acc = 0.04417670682730924
2021-06-16 13:05:54,913 - Discovery -   eval_acc = 0.12315930388219545
2021-06-16 13:05:54,913 - Discovery -   train_loss = 3.9321136474609375
2021-06-16 13:05:55,920 - Discovery - ***** Epoch: 5: Eval results *****
2021-06-16 13:05:55,921 - Discovery -   best_acc = 0.12315930388219545
2021-06-16 13:05:55,921 - Discovery -   eval_acc = 0.21686746987951808
2021-06-16 13:05:55,921 - Discovery -   train_loss = 3.818501631418864
2021-06-16 13:05:56,926 - Discovery - ***** Epoch: 6: Eval results *****
2021-06-16 13:05:56,927 - Discovery -   best_acc = 0.21686746987951808
2021-06-16 13:05:56,927 - Discovery -   eval_acc = 0.32262382864792505
2021-06-16 13:05:56,927 - Discovery -   train_loss = 3.5272518396377563
2021-06-16 13:05:57,935 - Discovery - ***** Epoch: 7: Eval results *****
2021-06-16 13:05:57,935 - Discovery -   best_acc = 0.32262382864792505
2021-06-16 13:05:57,935 - Discovery -   eval_acc = 0.3908969210174029
2021-06-16 13:05:57,935 - Discovery -   train_loss = 3.0917226870854697
2021-06-16 13:05:58,946 - Discovery - ***** Epoch: 8: Eval results *****
2021-06-16 13:05:58,946 - Discovery -   best_acc = 0.3908969210174029
2021-06-16 13:05:58,946 - Discovery -   eval_acc = 0.5180722891566265
2021-06-16 13:05:58,946 - Discovery -   train_loss = 2.5459768374760947
2021-06-16 13:05:59,960 - Discovery - ***** Epoch: 9: Eval results *****
2021-06-16 13:05:59,960 - Discovery -   best_acc = 0.5180722891566265
2021-06-16 13:05:59,960 - Discovery -   eval_acc = 0.5863453815261044
2021-06-16 13:05:59,960 - Discovery -   train_loss = 2.075600485006968
2021-06-16 13:06:00,982 - Discovery - ***** Epoch: 10: Eval results *****
2021-06-16 13:06:00,982 - Discovery -   best_acc = 0.5863453815261044
2021-06-16 13:06:00,982 - Discovery -   eval_acc = 0.6305220883534136
2021-06-16 13:06:00,984 - Discovery -   train_loss = 1.6661658088366191
2021-06-16 13:06:01,999 - Discovery - ***** Epoch: 11: Eval results *****
2021-06-16 13:06:01,999 - Discovery -   best_acc = 0.6305220883534136
2021-06-16 13:06:01,999 - Discovery -   eval_acc = 0.7001338688085676
2021-06-16 13:06:01,999 - Discovery -   train_loss = 1.287478764851888
2021-06-16 13:06:03,021 - Discovery - ***** Epoch: 12: Eval results *****
2021-06-16 13:06:03,021 - Discovery -   best_acc = 0.7001338688085676
2021-06-16 13:06:03,021 - Discovery -   eval_acc = 0.7041499330655957
2021-06-16 13:06:03,021 - Discovery -   train_loss = 1.0224595566590626
2021-06-16 13:06:04,097 - Discovery - ***** Epoch: 13: Eval results *****
2021-06-16 13:06:04,097 - Discovery -   best_acc = 0.7041499330655957
2021-06-16 13:06:04,097 - Discovery -   eval_acc = 0.7429718875502008
2021-06-16 13:06:04,097 - Discovery -   train_loss = 0.8245034615198771
2021-06-16 13:06:05,115 - Discovery - ***** Epoch: 14: Eval results *****
2021-06-16 13:06:05,115 - Discovery -   best_acc = 0.7429718875502008
2021-06-16 13:06:05,115 - Discovery -   eval_acc = 0.7643908969210174
2021-06-16 13:06:05,115 - Discovery -   train_loss = 0.6861645976702372
2021-06-16 13:06:06,133 - Discovery - ***** Epoch: 15: Eval results *****
2021-06-16 13:06:06,133 - Discovery -   best_acc = 0.7643908969210174
2021-06-16 13:06:06,133 - Discovery -   eval_acc = 0.7965194109772423
2021-06-16 13:06:06,133 - Discovery -   train_loss = 0.5271893441677094
2021-06-16 13:06:07,150 - Discovery - ***** Epoch: 16: Eval results *****
2021-06-16 13:06:07,150 - Discovery -   best_acc = 0.7965194109772423
2021-06-16 13:06:07,150 - Discovery -   eval_acc = 0.7938420348058902
2021-06-16 13:06:07,150 - Discovery -   train_loss = 0.44003981351852417
2021-06-16 13:06:08,159 - Discovery - ***** Epoch: 17: Eval results *****
2021-06-16 13:06:08,159 - Discovery -   best_acc = 0.7965194109772423
2021-06-16 13:06:08,159 - Discovery -   eval_acc = 0.7951807228915663
2021-06-16 13:06:08,159 - Discovery -   train_loss = 0.3534967104593913
2021-06-16 13:06:09,165 - Discovery - ***** Epoch: 18: Eval results *****
2021-06-16 13:06:09,166 - Discovery -   best_acc = 0.7965194109772423
2021-06-16 13:06:09,166 - Discovery -   eval_acc = 0.8005354752342704
2021-06-16 13:06:09,166 - Discovery -   train_loss = 0.3047488530476888
2021-06-16 13:06:10,184 - Discovery - ***** Epoch: 19: Eval results *****
2021-06-16 13:06:10,184 - Discovery -   best_acc = 0.8005354752342704
2021-06-16 13:06:10,184 - Discovery -   eval_acc = 0.8152610441767069
2021-06-16 13:06:10,184 - Discovery -   train_loss = 0.2476646453142166
2021-06-16 13:06:11,207 - Discovery - ***** Epoch: 20: Eval results *****
2021-06-16 13:06:11,207 - Discovery -   best_acc = 0.8152610441767069
2021-06-16 13:06:11,207 - Discovery -   eval_acc = 0.8058902275769746
2021-06-16 13:06:11,207 - Discovery -   train_loss = 0.21327878286441168
2021-06-16 13:06:12,224 - Discovery - ***** Epoch: 21: Eval results *****
2021-06-16 13:06:12,224 - Discovery -   best_acc = 0.8152610441767069
2021-06-16 13:06:12,224 - Discovery -   eval_acc = 0.8125836680053548
2021-06-16 13:06:12,224 - Discovery -   train_loss = 0.18626998861630759
2021-06-16 13:06:13,233 - Discovery - ***** Epoch: 22: Eval results *****
2021-06-16 13:06:13,234 - Discovery -   best_acc = 0.8152610441767069
2021-06-16 13:06:13,234 - Discovery -   eval_acc = 0.8139223560910308
2021-06-16 13:06:13,234 - Discovery -   train_loss = 0.16220769037803015
2021-06-16 13:06:14,243 - Discovery - ***** Epoch: 23: Eval results *****
2021-06-16 13:06:14,243 - Discovery -   best_acc = 0.8152610441767069
2021-06-16 13:06:14,244 - Discovery -   eval_acc = 0.8192771084337349
2021-06-16 13:06:14,244 - Discovery -   train_loss = 0.14874707659085593
2021-06-16 13:06:15,262 - Discovery - ***** Epoch: 24: Eval results *****
2021-06-16 13:06:15,263 - Discovery -   best_acc = 0.8192771084337349
2021-06-16 13:06:15,263 - Discovery -   eval_acc = 0.8165997322623829
2021-06-16 13:06:15,263 - Discovery -   train_loss = 0.13598028446237245
2021-06-16 13:06:16,275 - Discovery - ***** Epoch: 25: Eval results *****
2021-06-16 13:06:16,275 - Discovery -   best_acc = 0.8192771084337349
2021-06-16 13:06:16,275 - Discovery -   eval_acc = 0.8152610441767069
2021-06-16 13:06:16,275 - Discovery -   train_loss = 0.11585540821154912
2021-06-16 13:06:17,288 - Discovery - ***** Epoch: 26: Eval results *****
2021-06-16 13:06:17,288 - Discovery -   best_acc = 0.8192771084337349
2021-06-16 13:06:17,288 - Discovery -   eval_acc = 0.8246318607764391
2021-06-16 13:06:17,288 - Discovery -   train_loss = 0.10505873709917068
2021-06-16 13:06:18,312 - Discovery - ***** Epoch: 27: Eval results *****
2021-06-16 13:06:18,312 - Discovery -   best_acc = 0.8246318607764391
2021-06-16 13:06:18,312 - Discovery -   eval_acc = 0.8259705488621151
2021-06-16 13:06:18,312 - Discovery -   train_loss = 0.09589710707465808
2021-06-16 13:06:19,338 - Discovery - ***** Epoch: 28: Eval results *****
2021-06-16 13:06:19,338 - Discovery -   best_acc = 0.8259705488621151
2021-06-16 13:06:19,338 - Discovery -   eval_acc = 0.821954484605087
2021-06-16 13:06:19,338 - Discovery -   train_loss = 0.08651311819752057
2021-06-16 13:06:20,351 - Discovery - ***** Epoch: 29: Eval results *****
2021-06-16 13:06:20,351 - Discovery -   best_acc = 0.8259705488621151
2021-06-16 13:06:20,351 - Discovery -   eval_acc = 0.8259705488621151
2021-06-16 13:06:20,351 - Discovery -   train_loss = 0.08483844995498657
2021-06-16 13:06:21,371 - Discovery - ***** Epoch: 30: Eval results *****
2021-06-16 13:06:21,371 - Discovery -   best_acc = 0.8259705488621151
2021-06-16 13:06:21,371 - Discovery -   eval_acc = 0.8232931726907631
2021-06-16 13:06:21,371 - Discovery -   train_loss = 0.07751249521970749
2021-06-16 13:06:22,385 - Discovery - ***** Epoch: 31: Eval results *****
2021-06-16 13:06:22,385 - Discovery -   best_acc = 0.8259705488621151
2021-06-16 13:06:22,385 - Discovery -   eval_acc = 0.8246318607764391
2021-06-16 13:06:22,385 - Discovery -   train_loss = 0.0754686954120795
2021-06-16 13:06:23,399 - Discovery - ***** Epoch: 32: Eval results *****
2021-06-16 13:06:23,399 - Discovery -   best_acc = 0.8259705488621151
2021-06-16 13:06:23,399 - Discovery -   eval_acc = 0.8340026773761714
2021-06-16 13:06:23,399 - Discovery -   train_loss = 0.07180832574764888
2021-06-16 13:06:24,441 - Discovery - ***** Epoch: 33: Eval results *****
2021-06-16 13:06:24,441 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:24,441 - Discovery -   eval_acc = 0.8313253012048193
2021-06-16 13:06:24,441 - Discovery -   train_loss = 0.0669682150085767
2021-06-16 13:06:25,461 - Discovery - ***** Epoch: 34: Eval results *****
2021-06-16 13:06:25,461 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:25,461 - Discovery -   eval_acc = 0.820615796519411
2021-06-16 13:06:25,461 - Discovery -   train_loss = 0.061847249045968056
2021-06-16 13:06:26,475 - Discovery - ***** Epoch: 35: Eval results *****
2021-06-16 13:06:26,475 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:26,475 - Discovery -   eval_acc = 0.8246318607764391
2021-06-16 13:06:26,475 - Discovery -   train_loss = 0.05759630662699541
2021-06-16 13:06:27,495 - Discovery - ***** Epoch: 36: Eval results *****
2021-06-16 13:06:27,496 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:27,496 - Discovery -   eval_acc = 0.820615796519411
2021-06-16 13:06:27,496 - Discovery -   train_loss = 0.05906542452673117
2021-06-16 13:06:28,512 - Discovery - ***** Epoch: 37: Eval results *****
2021-06-16 13:06:28,512 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:28,512 - Discovery -   eval_acc = 0.8232931726907631
2021-06-16 13:06:28,512 - Discovery -   train_loss = 0.05674853983024756
2021-06-16 13:06:29,527 - Discovery - ***** Epoch: 38: Eval results *****
2021-06-16 13:06:29,527 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:29,527 - Discovery -   eval_acc = 0.820615796519411
2021-06-16 13:06:29,527 - Discovery -   train_loss = 0.053503300373752914
2021-06-16 13:06:30,543 - Discovery - ***** Epoch: 39: Eval results *****
2021-06-16 13:06:30,544 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:30,544 - Discovery -   eval_acc = 0.8192771084337349
2021-06-16 13:06:30,544 - Discovery -   train_loss = 0.04861884377896786
2021-06-16 13:06:31,561 - Discovery - ***** Epoch: 40: Eval results *****
2021-06-16 13:06:31,561 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:31,562 - Discovery -   eval_acc = 0.821954484605087
2021-06-16 13:06:31,562 - Discovery -   train_loss = 0.04915092761317889
2021-06-16 13:06:32,579 - Discovery - ***** Epoch: 41: Eval results *****
2021-06-16 13:06:32,579 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:32,581 - Discovery -   eval_acc = 0.8246318607764391
2021-06-16 13:06:32,581 - Discovery -   train_loss = 0.04525027548273405
2021-06-16 13:06:33,599 - Discovery - ***** Epoch: 42: Eval results *****
2021-06-16 13:06:33,599 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:33,599 - Discovery -   eval_acc = 0.8259705488621151
2021-06-16 13:06:33,599 - Discovery -   train_loss = 0.0428043349335591
2021-06-16 13:06:34,617 - Discovery - ***** Epoch: 43: Eval results *****
2021-06-16 13:06:34,617 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:34,617 - Discovery -   eval_acc = 0.8273092369477911
2021-06-16 13:06:34,617 - Discovery -   train_loss = 0.04235054521510998
2021-06-16 13:06:35,637 - Discovery - ***** Epoch: 44: Eval results *****
2021-06-16 13:06:35,637 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:35,637 - Discovery -   eval_acc = 0.8273092369477911
2021-06-16 13:06:35,637 - Discovery -   train_loss = 0.04414838987092177
2021-06-16 13:06:36,704 - Discovery - ***** Epoch: 45: Eval results *****
2021-06-16 13:06:36,704 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:36,704 - Discovery -   eval_acc = 0.8286479250334672
2021-06-16 13:06:36,704 - Discovery -   train_loss = 0.0402192206432422
2021-06-16 13:06:37,723 - Discovery - ***** Epoch: 46: Eval results *****
2021-06-16 13:06:37,723 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:37,723 - Discovery -   eval_acc = 0.8259705488621151
2021-06-16 13:06:37,723 - Discovery -   train_loss = 0.04063108377158642
2021-06-16 13:06:38,743 - Discovery - ***** Epoch: 47: Eval results *****
2021-06-16 13:06:38,743 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:38,743 - Discovery -   eval_acc = 0.8273092369477911
2021-06-16 13:06:38,743 - Discovery -   train_loss = 0.03807581774890423
2021-06-16 13:06:39,763 - Discovery - ***** Epoch: 48: Eval results *****
2021-06-16 13:06:39,763 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:39,763 - Discovery -   eval_acc = 0.8286479250334672
2021-06-16 13:06:39,763 - Discovery -   train_loss = 0.038013151536385216
2021-06-16 13:06:40,782 - Discovery - ***** Epoch: 49: Eval results *****
2021-06-16 13:06:40,782 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:40,783 - Discovery -   eval_acc = 0.8286479250334672
2021-06-16 13:06:40,783 - Discovery -   train_loss = 0.0374635054419438
2021-06-16 13:06:41,811 - Discovery - ***** Epoch: 50: Eval results *****
2021-06-16 13:06:41,811 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:41,811 - Discovery -   eval_acc = 0.8273092369477911
2021-06-16 13:06:41,811 - Discovery -   train_loss = 0.03827791785200437
2021-06-16 13:06:42,839 - Discovery - ***** Epoch: 51: Eval results *****
2021-06-16 13:06:42,839 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:42,839 - Discovery -   eval_acc = 0.8286479250334672
2021-06-16 13:06:42,841 - Discovery -   train_loss = 0.03495740331709385
2021-06-16 13:06:43,864 - Discovery - ***** Epoch: 52: Eval results *****
2021-06-16 13:06:43,864 - Discovery -   best_acc = 0.8340026773761714
2021-06-16 13:06:43,864 - Discovery -   eval_acc = 0.8246318607764391
2021-06-16 13:06:43,864 - Discovery -   train_loss = 0.03604894566039244
2021-06-16 13:06:43,865 - Discovery - Pre-training finished...
