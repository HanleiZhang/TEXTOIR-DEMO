2021-06-16 13:12:20,751 - Discovery - Open Intent Discovery Begin...
2021-06-16 13:12:20,751 - Discovery - Parameters Initialization...
2021-06-16 13:12:20,751 - Discovery - ============================== Params ==============================
2021-06-16 13:12:20,751 - Discovery - type:	open_intent_detection
2021-06-16 13:12:20,751 - Discovery - dataset:	banking
2021-06-16 13:12:20,751 - Discovery - known_cls_ratio:	0.75
2021-06-16 13:12:20,751 - Discovery - labeled_ratio:	0.1
2021-06-16 13:12:20,751 - Discovery - cluster_num_factor:	1
2021-06-16 13:12:20,751 - Discovery - method:	DeepAligned
2021-06-16 13:12:20,751 - Discovery - train:	True
2021-06-16 13:12:20,751 - Discovery - save_model:	False
2021-06-16 13:12:20,751 - Discovery - backbone:	bert
2021-06-16 13:12:20,751 - Discovery - num_train_epochs:	100
2021-06-16 13:12:20,751 - Discovery - setting:	semi_supervised
2021-06-16 13:12:20,752 - Discovery - config_file_name:	DeepAligned
2021-06-16 13:12:20,752 - Discovery - seed:	0
2021-06-16 13:12:20,752 - Discovery - gpu_id:	1
2021-06-16 13:12:20,752 - Discovery - pipe_results_path:	pipe_results
2021-06-16 13:12:20,752 - Discovery - data_dir:	/home/zhanghanlei/git/TEXTOIR/open_intent_discovery/../data
2021-06-16 13:12:20,752 - Discovery - output_dir:	outputs
2021-06-16 13:12:20,752 - Discovery - model_dir:	models
2021-06-16 13:12:20,752 - Discovery - result_dir:	results
2021-06-16 13:12:20,752 - Discovery - results_file_name:	results.csv
2021-06-16 13:12:20,752 - Discovery - save_results:	False
2021-06-16 13:12:20,752 - Discovery - method_output_dir:	outputs/open_intent_detection/DeepAligned_banking_0.75_0.1_bert
2021-06-16 13:12:20,752 - Discovery - model_output_dir:	outputs/open_intent_detection/DeepAligned_banking_0.75_0.1_bert/models
2021-06-16 13:12:20,752 - Discovery - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2021-06-16 13:12:20,752 - Discovery - max_seq_length:	None
2021-06-16 13:12:20,752 - Discovery - freeze_bert_parameters:	True
2021-06-16 13:12:20,752 - Discovery - feat_dim:	768
2021-06-16 13:12:20,752 - Discovery - warmup_proportion:	0.1
2021-06-16 13:12:20,752 - Discovery - lr_pre:	5e-05
2021-06-16 13:12:20,752 - Discovery - lr:	5e-05
2021-06-16 13:12:20,752 - Discovery - loss_fct:	CrossEntropyLoss
2021-06-16 13:12:20,752 - Discovery - train_batch_size:	128
2021-06-16 13:12:20,752 - Discovery - eval_batch_size:	128
2021-06-16 13:12:20,752 - Discovery - test_batch_size:	128
2021-06-16 13:12:20,752 - Discovery - wait_patient:	20
2021-06-16 13:12:20,752 - Discovery - ============================== End Params ==============================
2021-06-16 13:12:20,752 - Discovery - Data and Model Preparation...
2021-06-16 13:12:21,517 - Discovery - Number of labeled samples = 673
2021-06-16 13:12:21,518 - Discovery - Number of unlabeled samples = 8330
2021-06-16 13:12:28,236 - Discovery - Pre-raining start...
2021-06-16 13:12:31,995 - Discovery - ***** Epoch: 1: Eval results *****
2021-06-16 13:12:31,995 - Discovery -   best_acc = 0
2021-06-16 13:12:31,995 - Discovery -   eval_acc = 2.01
2021-06-16 13:12:31,995 - Discovery -   train_loss = 4.066388289133708
2021-06-16 13:12:32,997 - Discovery - ***** Epoch: 2: Eval results *****
2021-06-16 13:12:32,998 - Discovery -   best_acc = 2.01
2021-06-16 13:12:32,998 - Discovery -   eval_acc = 2.68
2021-06-16 13:12:32,998 - Discovery -   train_loss = 4.0482776165008545
2021-06-16 13:12:34,004 - Discovery - ***** Epoch: 3: Eval results *****
2021-06-16 13:12:34,004 - Discovery -   best_acc = 2.68
2021-06-16 13:12:34,004 - Discovery -   eval_acc = 4.42
2021-06-16 13:12:34,004 - Discovery -   train_loss = 4.003247181574504
2021-06-16 13:12:35,017 - Discovery - ***** Epoch: 4: Eval results *****
2021-06-16 13:12:35,017 - Discovery -   best_acc = 4.42
2021-06-16 13:12:35,017 - Discovery -   eval_acc = 12.32
2021-06-16 13:12:35,017 - Discovery -   train_loss = 3.9321136474609375
2021-06-16 13:12:36,025 - Discovery - ***** Epoch: 5: Eval results *****
2021-06-16 13:12:36,025 - Discovery -   best_acc = 12.32
2021-06-16 13:12:36,025 - Discovery -   eval_acc = 21.69
2021-06-16 13:12:36,025 - Discovery -   train_loss = 3.818501631418864
2021-06-16 13:12:37,033 - Discovery - ***** Epoch: 6: Eval results *****
2021-06-16 13:12:37,033 - Discovery -   best_acc = 21.69
2021-06-16 13:12:37,033 - Discovery -   eval_acc = 32.26
2021-06-16 13:12:37,033 - Discovery -   train_loss = 3.5272518396377563
2021-06-16 13:12:38,048 - Discovery - ***** Epoch: 7: Eval results *****
2021-06-16 13:12:38,048 - Discovery -   best_acc = 32.26
2021-06-16 13:12:38,048 - Discovery -   eval_acc = 39.09
2021-06-16 13:12:38,048 - Discovery -   train_loss = 3.0917226870854697
2021-06-16 13:12:39,059 - Discovery - ***** Epoch: 8: Eval results *****
2021-06-16 13:12:39,059 - Discovery -   best_acc = 39.09
2021-06-16 13:12:39,059 - Discovery -   eval_acc = 51.81
2021-06-16 13:12:39,059 - Discovery -   train_loss = 2.5459768374760947
2021-06-16 13:12:40,074 - Discovery - ***** Epoch: 9: Eval results *****
2021-06-16 13:12:40,074 - Discovery -   best_acc = 51.81
2021-06-16 13:12:40,074 - Discovery -   eval_acc = 58.63
2021-06-16 13:12:40,074 - Discovery -   train_loss = 2.075600485006968
2021-06-16 13:12:41,090 - Discovery - ***** Epoch: 10: Eval results *****
2021-06-16 13:12:41,090 - Discovery -   best_acc = 58.63
2021-06-16 13:12:41,090 - Discovery -   eval_acc = 63.05
2021-06-16 13:12:41,092 - Discovery -   train_loss = 1.6661658088366191
2021-06-16 13:12:42,121 - Discovery - ***** Epoch: 11: Eval results *****
2021-06-16 13:12:42,121 - Discovery -   best_acc = 63.05
2021-06-16 13:12:42,121 - Discovery -   eval_acc = 70.01
2021-06-16 13:12:42,121 - Discovery -   train_loss = 1.287478764851888
2021-06-16 13:12:43,133 - Discovery - ***** Epoch: 12: Eval results *****
2021-06-16 13:12:43,134 - Discovery -   best_acc = 70.01
2021-06-16 13:12:43,134 - Discovery -   eval_acc = 70.41
2021-06-16 13:12:43,134 - Discovery -   train_loss = 1.0224595566590626
2021-06-16 13:12:44,199 - Discovery - ***** Epoch: 13: Eval results *****
2021-06-16 13:12:44,199 - Discovery -   best_acc = 70.41
2021-06-16 13:12:44,199 - Discovery -   eval_acc = 74.3
2021-06-16 13:12:44,199 - Discovery -   train_loss = 0.8245034615198771
2021-06-16 13:12:45,212 - Discovery - ***** Epoch: 14: Eval results *****
2021-06-16 13:12:45,212 - Discovery -   best_acc = 74.3
2021-06-16 13:12:45,212 - Discovery -   eval_acc = 76.44
2021-06-16 13:12:45,212 - Discovery -   train_loss = 0.6861645976702372
2021-06-16 13:12:46,227 - Discovery - ***** Epoch: 15: Eval results *****
2021-06-16 13:12:46,227 - Discovery -   best_acc = 76.44
2021-06-16 13:12:46,227 - Discovery -   eval_acc = 79.65
2021-06-16 13:12:46,227 - Discovery -   train_loss = 0.5271893441677094
2021-06-16 13:12:47,242 - Discovery - ***** Epoch: 16: Eval results *****
2021-06-16 13:12:47,242 - Discovery -   best_acc = 79.65
2021-06-16 13:12:47,243 - Discovery -   eval_acc = 79.38
2021-06-16 13:12:47,243 - Discovery -   train_loss = 0.44003981351852417
2021-06-16 13:12:48,249 - Discovery - ***** Epoch: 17: Eval results *****
2021-06-16 13:12:48,249 - Discovery -   best_acc = 79.65
2021-06-16 13:12:48,249 - Discovery -   eval_acc = 79.52
2021-06-16 13:12:48,249 - Discovery -   train_loss = 0.3534967104593913
2021-06-16 13:12:49,254 - Discovery - ***** Epoch: 18: Eval results *****
2021-06-16 13:12:49,254 - Discovery -   best_acc = 79.65
2021-06-16 13:12:49,254 - Discovery -   eval_acc = 80.05
2021-06-16 13:12:49,254 - Discovery -   train_loss = 0.3047488530476888
2021-06-16 13:12:50,271 - Discovery - ***** Epoch: 19: Eval results *****
2021-06-16 13:12:50,271 - Discovery -   best_acc = 80.05
2021-06-16 13:12:50,271 - Discovery -   eval_acc = 81.53
2021-06-16 13:12:50,271 - Discovery -   train_loss = 0.2476646453142166
2021-06-16 13:12:51,288 - Discovery - ***** Epoch: 20: Eval results *****
2021-06-16 13:12:51,288 - Discovery -   best_acc = 81.53
2021-06-16 13:12:51,288 - Discovery -   eval_acc = 80.59
2021-06-16 13:12:51,290 - Discovery -   train_loss = 0.21327878286441168
