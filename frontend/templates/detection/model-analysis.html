<!DOCTYPE html>
<html class="x-admin-sm">

    <head>
        <meta charset="UTF-8">
        <title>New Intent Discovery System</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <link rel="stylesheet" href="/static/lib/xadmin/css/font.css">
        <link rel="stylesheet" href="/static/lib/xadmin/css/xadmin.css">
        <script type="text/javascript" src="/static/lib/jquery-3.2.1.js" charset="utf-8"></script>
        <script type="text/javascript" src="/static/lib/layui/layui.js" charset="utf-8"></script>
        <script type="text/javascript" src="/static/lib/xadmin/js/xadmin.js"></script>
        <script src="/static/lib/xadmin/js/echarts.min.js"></script>
        <script src="/static/lib/xadmin/js/ecStat.js"></script>
    </head>
    <body>
        <!-- model-list -->
        <div class="layui-fluid">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-card">
                        <div class="layui-card-body ">

                            <div style="font-weight:700; font-size:20px;color:#555555">Open Intent Detection</div>
                            <div style="color:#6F6F6F">--Here,You can identify known intents and detect the open intent.</div>
    
                            <form class="layui-form" enctype="multipart/form-data">
                                
                                
                                    <div class="layui-input-inline">
                                        
                                        <div class="layui-input-inline ">
                                            <div class="layui-form-item" style="position: relative;left: 57%">
                                                <select id = 'dataset_select_detection' name="dataset_select_detection" value = "{{lines.dataset_name}}" lay-filter="dataset_select_detecti" onclick="switchBySelect()"> 
                                                    <option value="-1" selected>Dataset</option>
                                                    {% for lines in dataset_list %}
                                                        <option  value="{{lines.dataset_id}}" >{{lines.dataset_name}}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                        <!-- <div class="layui-input-inline ">
                                            <div class="layui-form-item" style="position: relative;left: 57%">
                                                <select id = 'dataset_select_detection' name="dataset_select_detection" value = "{{lines.dataset_name}}" lay-filter="dataset_select_detecti" onclick="switchBySelect()"> 
                                                    <option value="-1" selected>Dataset</option>
                                                    {% for lines in dataset_list %}
                                                        {% if lines.dataset_name == 'banking' %}
                                                        <option   value="{{lines.dataset_id}}" >{{lines.dataset_name}}</option>
                                                        {% endif %}
                                                        
                                                        {% if lines.model_name != 'banking' %}
                                                        <option  value="{{lines.dataset_id}}" >{{lines.dataset_name}}</option>
                                                        {% endif %}
                                                    {% endfor %}
                                                    <option >Dataset</option>
                                                    {% for lines in dataset_list %}
                                                        <option  value="{{lines.dataset_id}}" >{{lines.dataset_name}}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div> -->
    
                                        <div class="layui-input-inline" >
                                            <div class="layui-form-item" style="position: relative;left: 77%">
                                                <select id="model_detection" name="model_detection" >
                                                    <option value="Open Intent Detection" selected >Open Intent Detection</option>
                                                        {% for lines in modelList_detection %}
                                                            <option  value="{{lines.model_name}}" >{{lines.model_name}}</option>
                                                        {% endfor %}
                                                        <!-- {% for lines in modelList_detection %}
                                                            {% if lines.model_name == 'MSP' %}
                                                            <option   value="{{lines.model_name}}" >{{lines.model_name}}</option>
                                                            {% endif %}
                                                            
                                                            {% if lines.model_name != 'MSP' %}
                                                            <option  value="{{lines.model_name}}" >{{lines.model_name}}</option>
                                                            {% endif %}
                                                        {% endfor %} -->
                                                </select>
                                            </div>
                                        </div>
    
                                       
                                        <div class="layui-input-inline">
    
                                            <div class="layui-input-inline">
                                                <div class="layui-form-item" style="position:relative">
                                                    <button class="layui-btn" lay-filter="detection_test" lay-submit="" style=" position: relative;left: 400%">Test</button>
                                                </div>
                                            </div>
                                            <div class="layui-input-inline">
                                                <div class="layui-form-item" style="position:relative">
                                                    <button class="layui-btn layui-btn-danger"   style="position: relative;left: 600%" type ='reset'>Clear</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                               
                            </form> 
    
                            <div style="font-weight:700; font-size:20px;color:#555555">Analysis of Model Results </div>
                            <div style="color:#6F6F6F">--Show the model results of identified intents.</div>
                            <div class="layui-card-body ">
                                <table class="layui-table layui-form" id="classTable" lay-filter="demoEvent" >
                                </table>
                            </div>
                            <div style="font-weight:700; font-size:20px;color:#555555">Analysis of Model Details </div>
                            <div style="color:#6F6F6F">--Show the detailed results of different models.</div>
                            
                            <div class="layui-form-item">
                                <!-- <div id="ADB" style="display:none;position:absolute;right: 0px;z-index:999"> -->

                                <!-- </div> -->
                                <div id="ADB_msg" style="font-weight:550; font-size:15px;color:#555555;text-align:center">We project the high-dimensional points into the two-dimensional coordinate plane !</div>
                            </div>

                                <div class="layui-form-item">
                                    <div id="doc" style="display:none;position:absolute;right: 20%;z-index:999">
                                        <div class="layui-input-inline">
                                                <div class="layui-input-inline">
                                                    <div style="font-weight:600; font-size:18px;color:#555555">Select Intent Class: </div>
                                                </div>
                                                <form class="layui-form" >
                                                    <div class="layui-input-inline">
                                                        <select id="select_data"  lay-filter="select_intent">
                                                        </select>
                                                    </div>
                                                </form>
                                        </div>    
                                    </div>
                                </div>
                                <!-- <a id="download" href="">下载</a> -->
                                <div class="layui-form-item">
                                    <div id="image1" style="width:750px; height:574px; left:0; right:0; margin:auto;" ></div>
                                </div>
                        </div>
                    </div>
                
                </div>
            </div>
        </div>
        <script>layui.use(['form', 'layer','jquery','table'],
            function() {
                $ = layui.jquery;
                var form = layui.form,
                layer = layui.layer;
                table = layui.table;



                 // DOC__
                    form.on('select(select_intent)', function(data) {
                    console.log('my_test: '+data.value);
                    var doc_intent = data.value;
                    var t  = data_chart_0.Intent_Class.indexOf(doc_intent);
                    var myChart1 = echarts.init(document.getElementById('image1'));
                            myChart1.hideLoading();
                            var series = [];
                            var legend = [];
                            var i = 0 ;
                            var intent_data =[];                          
                            var my_color = ['rgba(255, 102, 102,0.8)','rgba(102, 204, 204,0.8)'];
                            data_str = "DOC_"+dataset_select_detection+"_Content"
                            x_str = "DOC_"+dataset_select_detection+"_Xaxis"
                            x_key = doc_intent+"_xaxis"
                            th_str = "DOC_"+dataset_select_detection+"_Index"
                             $.get('/static/json/my_json.json', function (data) {
                                data_chart_1 = data[data_str][doc_intent];
                                data_length = data_chart_1.Known_Intent.length-1;
                                doc_threshold = data[th_str]["Intent_Threshold"]
                                console.log("low_threshold: "+doc_threshold)
                                myChart1.hideLoading();  // 
                                myChart1.clear();//清除缓存
                                //get /static/json/bar_test.json
                                doc_data_chart_x = data[x_str][x_key];
                                for(var key in data_chart_1){
                                    legend.push(key); 
                                    intent_data.push(data_chart_1[key]);
                                    console.log("my_:++++++ "+doc_threshold[t])   
                                    series.push({
                                        type:'line',
                                        markLine : {
                                                    symbol:"none",               
                                                    label:{
                                                        position:"end",
                                                        color:'blue',
                                                        fontWeight: 'bolder',
                                                        formatter: function (params) {
                                                            

                                                        str = "Statistics Threshold: " + doc_threshold[t]                                            
                                                        return str
                                                        },          
                                                    },
                                                    data : [{
                                                        silent:false,  
                                                        lineStyle:{               
                                                            type:"solid",
                                                            color:"blue",
                                                        },
                                                        xAxis: doc_threshold[t],
                                                      
                                                    }]
                                                }
                                    }) 
                                    series.push({
                                            name: key,
                                            type: 'bar',
                                            color:my_color[i],
                                            barGap: '-100%',//添加此配置项即为重叠效果  被重叠
                                            barCategoryGap: "10%",
                                            data: data_chart_1[key],
                                            
                                        });
                                        i = i+1;
                                       
                                    };
                                
                                myChart1.setOption({                                   
                                    tooltip : {
                                    trigger: 'axis',
                                    axisPointer:{
                                        lineStyle:{
                                            color:"blue",
                                            type:'line',
                                        }
                                    },
                                    formatter:function(params){                                        
                                        var sumNum_k = 0;
                                        var sumNum_n = 0;
                                        var sumAll = 0;
                                        for(i=0;i<=data_length;i++){ 
                                            sumAll = sumAll + (-intent_data[1][i])+ intent_data[0][i];
                                        };
                                        console.log(data_length);
                                        console.log(sumAll);
                                        for(i=data_length;i>params[0].dataIndex;i--){ 
                                            sumNum_k = sumNum_k + intent_data[0][i];
                                        };
                                        for(i=0;i<params[0].dataIndex;i++){ 
                                            sumNum_n = sumNum_n + (-intent_data[1][i]);
                                        };
                                        score = ((sumNum_k+sumNum_n)/sumAll).toFixed(2);
                                        if(params[0] == undefined & params[1] == undefined){
                                            return false
                                        }else if(params[0] == undefined){
                                            mystr = params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[1].value+"<br>"+'</span>';
                                            return mystr
                                        }else if(params[1] == undefined){
                                            mystr = params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[0].value+"<br>"+'</span>';
                                            return mystr
                                        }else{
                                            console.log("This isnt null-------"+(params[0].name-0.05))
                                            mystr = 'Threshold: '+'<span style="font-weight:800;font-size:13px;">'
                                            +params[0].name+"<br>"+'</span>'
                                            +params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+sumNum_k+"<br>"+'</span>'
                                            +params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+sumNum_n+"<br>"+'</span>'
                                            +'Score: '+'<span style="font-weight:800;font-size:13px;">'+score+"<br>"+'</span>';
                                            return mystr
                                        }
                                    },
                                    textStyle:{
                                　　align:'left'
                                　　　},
                                    }, 
                                    legend: {
                                        data: legend,
                                    },
                        
                                    grid: {
                                        left: '5%',
                                        right: '25%',
                                        bottom: '3%',
                                        top:'20%',
                                        containLabel: true
                                    },
                                    //0403
                                    xAxis: {
                                        name:'Confidence Score',
                                        type: 'category',
                                        data: doc_data_chart_x,
                                        nameTextStyle:{
                                            fontWeight:550,
                                        },
                                        axisLabel:{
                                            show: true,
                                            textStyle:{
                                            fontWeight: 550,
                                            fontSize:12
                                        }
                                    }
                                    },
                                    yAxis: { 
                                        name:'Numbers of Samples',
                                        type: 'value',
                                        boundaryGap: [0, 0.01],
                                        nameTextStyle:{
                                                fontWeight:550,
                                            },
                                            axisLabel:{
                                                show: true,
                                                textStyle:{
                                                fontWeight: 550,
                                                fontSize:12
                                            }
                                        }
                                    },
                                    series: series,
                            })
                            }, 'json');
                });

            });
            </script>
  
        <script>layui.use(['form', 'layer','jquery','table'],
            function() {
                $ = layui.jquery;
                var form = layui.form,
                layer = layui.layer;
                table = layui.table;

                var classTable = table.render({
                    elem: "#classTable",
                    url: '/detection/model_analysis/model_analysis_getClassListByDatasetNameAndMethod',
                    cellMinWidth: 80,
                    page: { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                        layout: ['prev', 'page', 'next' , 'count' ] //自定义分页布局
                        //,curr: 5 //设定初始在第 5 页
                        ,first: 'first'
                        ,last: 'last'
                        ,limit: '5'
                        ,curr: '1'
                        
                    },
                    cols: [[
                        {field: 'label_name', title: 'Identified Intents' ,event: 'sub_known', align: 'left', templet: function(d) {
                            label_name_tmp = d.label_name;
                            if (d.label_name == "<UNK>" || d.label_name == "oos"){
                                label_name_tmp = "< UNK >"
                            }

                            return '<div style="position: relative;\n' + '    padding: 0 10px 0 20px;">' + label_name_tmp + '<i style="left: 0px;" lay-tips="Show Details" class="layui-icon layui-colla-icon layui-icon-right"></i></div>'
                        }}
                        ,{field: 'label_text_num', title: 'Numbers' ,width:'20%', align: 'center'}
                    ]]
                    ,where:{
                        "dataset_name": "banking",
                        "method": "ADB"
                    }
                });

               


                //监听单元格事件
                table.on('tool(demoEvent)', function(obj){
                    var data = obj.data;
                    // console.log(data)
                    if(obj.event === 'sub_known' && data.label_name != undefined ){
                        //layer.msg('145:点击了sub_known')
                        // 打开折叠面板，显示对应信息
                        var trObj = layui.$(this).parent('tr'); //当前行
                        var accordion = true //开启手风琴，那么在进行折叠操作时，始终只会展现当前展开的表格。
                        var content = '<table ></table>' //内容
                        var optionForText = getOptionsForTextTableOfKnown(trObj, accordion, content, obj.event, data.dataset_name, 'known', data.label_name, data.method)
                        collapseTable(optionForText)
                    }
                });

                form.on('submit(detection_test)',
                function(data) {
                    console.log('data===='+data);                   
                    var form_data = new FormData();
                    form_data.append('model_detection', $('#model_detection').val());
                    form_data.append('dataset_select_detection', $('#dataset_select_detection').val());
                    console.log(form_data);
                    //image_show
                    model_detection = $('#model_detection').val()
                    // dataset_select_detection = $('#dataset_select_detection').val()
                    dataset_select_detection = $('#dataset_select_detection').find("option:selected").text()
                    console.log("datasetname:   "+dataset_select_detection)
                    if(model_detection == 'Open Intent Detection'){
                        layer.msg('Please select Model');
                    } else if( dataset_select_detection == -1 ||  dataset_select_detection == 'Dataset' ){
                        layer.msg('Please select Dataset');
                    }else{
                        if(model_detection == "ADB"){
                            $('#ADB_msg').show();
                        }else{
                            $('#ADB_msg').hide();
                        }


                        console.log('175:\t'+$('#dataset_select_detection').find("option:selected").text())
                        // table reload
                        classTable.reload({
                            where: { //设定异步数据接口的额外参数，任意设
                                "dataset_name": $('#dataset_select_detection').find("option:selected").text(),
                                "method": $('#model_detection').find("option:selected").text()
                                }
                            ,page: { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                                layout: ['prev', 'page', 'next' , 'count' ] //自定义分页布局
                                //,curr: 5 //设定初始在第 5 页
                                ,first: 'first'
                                ,last: 'last'
                                
                            }
                        });
                        if(model_detection == 'MSP'){// 渲染图表
                        $('#doc').hide();
                        // $('#doc').show();
                        // const a = window.document.querySelector('#download')
                        // a.addEventListener('click',()=>{
                        //     const content = document.querySelector('svg').outerHTML
                        //     const blob= new Blob([content], {type: 'xml/svg'})
                        //     a.href = URL.createObjectURL(blob)
                        //     a.download = 'test.svg'
                        // })

                        var myChart2 = echarts.init(document.getElementById('image1'), null, {renderer: 'svg'});
                            myChart2.hideLoading();
                            var series = [];
                            var legend = [];
                            var i = 0 ;
                            var intent_data =[];                          
                            var my_color = ['rgba(255, 102, 102,0.8)','rgba(102, 204, 204,0.8)'];
                            console.log(my_color[0])
                            
                             $.get('/static/jsons/open_intent_detection/MSP_analysis.json', function (data) {
                                data_chart_2 = data["MSP_banking"];
                                msp_data_chart_x = data["MSP_banking_x"]["xais"];
                                data_length = data_chart_2.Known_Intent.length-1;
                                console.log(data_length);
                                myChart2.hideLoading();  // 
                                myChart2.clear();//清除缓存
                                //get /static/json/bar_test.json
                                for(var key in data_chart_2){
                                    series.push(
                                        {
                                            type:'line',
                                            markLine : {
                                                        symbol:"none",               
                                                        label:{
                                                            position:"end",
                                                            color:'blue',
                                                            fontWeight: 'bolder',
                                                            formatter: function (params) {
                                                            str = "Default Threshold: " + '0.5'                                            
                                                            return str
                                                            },          
                                                        },
                                                        data : [{
                                                            silent:false,  
                                                            lineStyle:{               
                                                                type:"solid",
                                                                color:"blue",
                                                            },
                                                            xAxis:'0.5',
                                                        }]
                                                    }

                                        }
                                    )
                                    legend.push(key); 
                                    intent_data.push(data_chart_2[key]);
                                    series.push({
                                                name: key,
                                                type: 'bar',
                                                color:my_color[i],
                                                barGap: '-100%',//添加此配置项即为重叠效果  被重叠
                                                barCategoryGap: "10%",
                                                data: data_chart_2[key],
                                              

                                            });
                                        i = i+1;                                       
                                    };                                   
                                myChart2.setOption({                                   
                                    tooltip : {
                                    trigger: 'axis',
                                    axisPointer:{
                                        lineStyle:{
                                            color:"blue",
                                            type:'line',
                                        }
                                    },
                                    formatter:function(params){                                        
                                        var sumNum_k = 0;
                                        var sumNum_n = 0;
                                        var sumAll = 0;
                                        for(i=0;i<=data_length;i++){ 
                                            sumAll = sumAll + (-intent_data[1][i])+ intent_data[0][i];
                                        };
                                        console.log(data_length);
                                        console.log(sumAll);
                                        for(i=data_length;i>params[0].dataIndex;i--){ 
                                            sumNum_k = sumNum_k + intent_data[0][i];
                                        };
                                        for(i=0;i<params[0].dataIndex;i++){ 
                                            sumNum_n = sumNum_n + (-intent_data[1][i]);
                                        };
                                        score = ((sumNum_k+sumNum_n)/sumAll).toFixed(2);
                                        if(params[0] == undefined & params[1] == undefined){
                                            return false
                                        }else if(params[0] == undefined){
                                            mystr = params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[1].value+"<br>"+'</span>';
                                            return mystr
                                        }else if(params[1] == undefined){
                                            mystr = params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[0].value+"<br>"+'</span>';
                                            return mystr
                                        }else{
                                            console.log("This isnt null")
                                            mystr = 'Threshold: '+'<span style="font-weight:800;font-size:13px;">'+params[0].name+"<br>"+'</span>'
                                            +params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+sumNum_k+"<br>"+'</span>'
                                            +params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+sumNum_n+"<br>"+'</span>'
                                            +'Score: '+'<span style="font-weight:800;font-size:13px;">'+score+"<br>"+'</span>';
                                            return mystr
                                        }
                                        
                                        
                                    },
                                    textStyle:{
                                　　align:'left'
                                　　　},
                                    }, 
                                    legend: {
                                        data: legend,
                                    },
                                   
                                    grid: {
                                        left: '5%',
                                        right: '25%',
                                        bottom: '3%',
                                        top:'20%',
                                        containLabel: true
                                    },
                                    xAxis: {
                                        name:'Confidence Score',
                                        type: 'category',
                                        data:  msp_data_chart_x,
                                        nameTextStyle:{
                                            fontWeight:550,
                                        },
                                        axisLabel:{
                                            show: true,
                                            textStyle:{
                                            fontWeight: 550,
                                            fontSize:12
                                        }
                                    }
                                                    },
                                    yAxis: { 
                                        name:'Numbers of Samples',
                                        type: 'value',
                                        boundaryGap: [0, 0.01],
                                        nameTextStyle:{
                                                fontWeight:550,
                                            },
                                            axisLabel:{
                                                show: true,
                                                textStyle:{
                                                fontWeight: 550,
                                                fontSize:12
                                            }
                                        }
                                    },
                                    
                                    series: series,
                            })
                            }, 'json');

                    }
                    else if(model_detection == 'ADB'){// 渲染图表
                        $('#doc').hide();
                            var myChart4 = echarts.init(document.getElementById('image1'), null, {renderer: 'svg'});
                            myChart4.hideLoading();
                            var series = [];//保存散点
                            var mylegend = [];//legend部分使用
                            var graphic = [];//保存圆                          
                            //get cluster.json
                            $.get('/static/jsons/open_intent_detection/ADB_analysis.json', function (data) {
                               
                                data_chart_5 = data["points_banking"];
                                
                                myChart4.clear();//清除缓存
                                //循环显示散点
                                //换行显示legend
                                mylegend.push('');
                                var i = 0;
                                color_list=[
                                '#5470c6','#91cc75','#fac858','#ee6666','#73c0de','#3ba272','#fc8452','#9a60b4','#ea7ccc','#BBFFFF',
                        '#FFDEAD','	#00868B','#66CDAA','#BEBEBE','#00FF7F','#00CD00','#FFFF00','#FFC1C1','#B8860B','#FF8247',
                        '#B22222','#FF4500','#7B68EE','#458B00','#B0C4DE','#CAFF70','#EEE685','#556B2F','#20B2AA','#32CD32',
                        '#8B658B','#BC8F8F','#CD5555','#DEB887','#B22222','#FA8072','#EEE8AA','#EE9A49','#FF69B4','#8B4513',
                        '#EE82EE','#FF8C69','#9932CC','	#CDC9C9','#EED5B7','#CD4F39','#EE4000','#CDC1C5','#FF34B3','#FFE4E1',
                        '#F0FFFF','#EE3A8C','#836FFF','#EE00EE','#473C8B','#FF83FA','#436EEE','#CD69C9','#0000FF','#CD96CD',
                        '#1E90FF','#E066FF','#1874CD','#7A378B','#5CACEE','#9A32CD','#00B2EE','	#7D26CD','#00688B','#AB82FF',
                        '#6CA6CD','#EED2EE','#8DB6CD','#8B7B8B','#B9D3EE','#6C7B8B','#E0FFFF','#00008B','#D1EEEE','#8B008B',
                        '#8B0000','#90EE90','#DCDCDC','#98F5FF','#FFEBCD','#00C5CD','#FFE4B5','#00CDCD','#79CDCD','#76EEC6',
                        '#FFE4E1','#B4EEB4','#696969','#4EEE94','#6495ED','#00FF7F','#7B68EE','#00FF00','#0000FF','#87CEEB',
                        '#458B00','#00CED1','#BCEE68','#00FFFF','#FFF68F','#7FFFD4','#FFEC8B','#2E8B57','#FFFFE0','#98FB98',
                        '#CDCD00','#00FA9A','#EEC900','	#9ACD32','#EEB422','#8FBC8F','#EEDD82','#EEB4B4','#8B6969','#CD5C5C',
                        '#8B4513','#EE6363','#CD853F','#8B3A3A','#F4A460','#CD6839','#B22222','#FFE7BA','#6B8E23','#FFA54F',
                        '#FF7F50','#CD853F','#FF69B4','#8B4513','#FFB6C1','#CD2626','#FF00FF','#BA55D3','#EE9572','#D8BFD8',
                        '#36648B','#9B30FF','#009ACD','#AB82FF','#A4D3EE','#BFEFFF','#8B008B','#FF34B3','#FF8C00','#228B22'

                                ];
                                for (var key in data_chart_5){
                                    mylegend.push(key);
                                    
                                    series.push({
                                        color:color_list[i],
                                        name:key,
                                        type:'scatter',
                                        data:data_chart_5[key],
                                        itemStyle: {
                                                borderColor: '#555',   
                                            },
                                            tooltip: {
                                                trigger:'item',
                                                formatter:function(params){
                                                    //console.log(params);                                                             
                                                    var dotHtml2 = '<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#666666"></span>'
                                                    mystr ='<span style="font-size:10px;">'+params.seriesName+"</br>"
                                                        +dotHtml2+"Point:"+'</span>' + '<span style="font-weight:800;font-size:14px;">'+"  " +'('+params.data[0]+','+params.data[1]+')'+'</span>'+'<br>'
                                                        +dotHtml2+"Center:"+'</span>' + '<span style="font-weight:800;font-size:14px;">'+"  " +'('+params.data[2]+','+params.data[3]+')'+'</span>'+'<br>'
                                                        +dotHtml2+"Radiu:"+'</span>' + '<span style="font-weight:800;font-size:14px;">'+"  " +params.data[4]+'</span>';
                                                    return mystr;
                                                    //console.log(params);
                                                }                                                
                                        }
                                    });
                                    i = i+1;
                                };
                                myChart4.setOption({
                                        xAxis: {
                                        },
                                        yAxis: {
                                        },
                                        legend: { type: 'scroll', top: 30, data: mylegend },
                                        tooltip: {
                                        },                                       
                                        series: series,
                                    //画圆
                                        graphic:graphic,
                                    })
                            }, 'json');
                        }else if(model_detection == 'DeepUnk'){
                            $('#doc').hide();
                            var myChart4 = echarts.init(document.getElementById('image1'));                                       
                            myChart4.hideLoading();
                            var series = [];//保存散点
                            var mylegend = [];//legend部分使用
                            $.get('/static/json/my_json.json', function (data) {
                                data_chart_5 = data["density"];
                                myChart4.clear();//清除缓存
                                mylegend.push('');
                                for (var key in data_chart_5){
                                    mylegend.push(key);
                                    series.push({
                                        name:key,
                                        type:'scatter',
                                        data:data_chart_5[key],                                       
                                        itemStyle: {
                                                normal: {
                                                    borderColor: '#555',
                                                    label: {
                                                        show: true,
                                                        color: '#6F6F6F',
                                                        position: 'right',
                                                        fontWeight: 'bolder',
                                                        formatter: function (params, ticket, callback) {
                                                            var s = "Density: \""+params.value[2]+"\""; 
                                                            return s
                                                        },
                                                    },
                                                },
                                            },
                                            tooltip: {
                                                trigger:'item',
                                                formatter:function(params){
                                                    //console.log(params);                                                             
                                                    var dotHtml2 = '<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#666666"></span>'
                                                    mystr ='<span style="font-size:10px;">'+params.seriesName+"</br>"+dotHtml2+"Density:"+'</span>' + '<span style="font-weight:800;font-size:14px;">'+"  " +params.data[2]+'</span>'+"</br>"+dotHtml2+"Center:"+'</span>' + '<span style="font-weight:800;font-size:14px;">'+"  " +'('+params.data[0]+','+params.data[1]+')'+'</span>';
                                                    return mystr;
                                                    //console.log(params);
                                                }                                                
                                        }
                                    });
                                };
                                myChart4.setOption({
                                    //X,Y轴还必须要有
                                        xAxis: {nameTextStyle:{
                                            fontWeight:550,
                                        },
                                        axisLabel:{
                                            show: true,
                                            textStyle:{
                                            fontWeight: 550,
                                            fontSize:12
                                        }
                                    }},
                                        yAxis: {
                                            nameTextStyle:{
                                                fontWeight:550,
                                            },
                                            axisLabel:{
                                                show: true,
                                                textStyle:{
                                                fontWeight: 550,
                                                fontSize:12
                                            }
                                        }
                                        },
                                        legend: {
                                            data:mylegend
                                            },
                                        tooltip: {
                                        },
                                        // x轴拖动
                                        dataZoom: [
                                        {
                                            type: "slider",
                                            realtime: true, //拖动滚动条时是否动态的更新图表数据
                                            height: 15, //滚动条高度
                                            left:"10%",
                                            right:"5%",
                                            start: 0, //滚动条开始位置（共100等份）
                                            end: 100, //结束位置（共100等份）
                                        },
                                        {
                                                type: 'slider',
                                                show: true,
                                                yAxisIndex: [0],
                                                left: '93%',
                                                right:"5%",
                                                start: 0, //数据窗口范围的起始百分比
                                                end: 1000
                                            }
                                        ],
                                        color:[
                        '#5470c6','#91cc75','#fac858','#ee6666','#73c0de','#3ba272','#fc8452','#9a60b4','#ea7ccc','#BBFFFF',
                        '#FFDEAD','	#00868B','#66CDAA','#BEBEBE','#00FF7F','#00CD00','#FFFF00','#FFC1C1','#B8860B','#FF8247',
                        '#B22222','#FF4500','#7B68EE','#458B00','#B0C4DE','#CAFF70','#EEE685','#556B2F','#20B2AA','#32CD32',
                        '#8B658B','#BC8F8F','#CD5555','#DEB887','#B22222','#FA8072','#EEE8AA','#EE9A49','#FF69B4','#8B4513',
                        '#EE82EE','#FF8C69','#9932CC','	#CDC9C9','#EED5B7','#CD4F39','#EE4000','#CDC1C5','#FF34B3','#FFE4E1',
                        '#F0FFFF','#EE3A8C','#836FFF','#EE00EE','#473C8B','#FF83FA','#436EEE','#CD69C9','#0000FF','#CD96CD',
                        '#1E90FF','#E066FF','#1874CD','#7A378B','#5CACEE','#9A32CD','#00B2EE','	#7D26CD','#00688B','#AB82FF',
                        '#6CA6CD','#EED2EE','#8DB6CD','#8B7B8B','#B9D3EE','#6C7B8B','#E0FFFF','#00008B','#D1EEEE','#8B008B',
                        '#8B0000','#90EE90','#DCDCDC','#98F5FF','#FFEBCD','#00C5CD','#FFE4B5','#00CDCD','#79CDCD','#76EEC6',
                        '#FFE4E1','#B4EEB4','#696969','#4EEE94','#6495ED','#00FF7F','#7B68EE','#00FF00','#0000FF','#87CEEB',
                        '#458B00','#00CED1','#BCEE68','#00FFFF','#FFF68F','#7FFFD4','#FFEC8B','#2E8B57','#FFFFE0','#98FB98',
                        '#CDCD00','#00FA9A','#EEC900','	#9ACD32','#EEB422','#8FBC8F','#EEDD82','#EEB4B4','#8B6969','#CD5C5C',
                        '#8B4513','#EE6363','#CD853F','#8B3A3A','#F4A460','#CD6839','#B22222','#FFE7BA','#6B8E23','#FFA54F',
                        '#FF7F50','#CD853F','#FF69B4','#8B4513','#FFB6C1','#CD2626','#FF00FF','#BA55D3','#EE9572','#D8BFD8',
                        '#36648B','#9B30FF','#009ACD','#AB82FF','#A4D3EE','#BFEFFF','#8B008B','#FF34B3','#FF8C00','#228B22'
                    ],
                                        series: series,
                                    })
                            }, 'json');  
                    }else if(model_detection == 'DOC'){
                        $('#doc').show();
                        $("#select_data").empty();

                        form.render('select');
                        doc_data_str = "DOC_"+dataset_select_detection+"_Index";
                        console.log(doc_data_str);

                        var myChart1 = echarts.init(document.getElementById('image1'));
                                myChart1.hideLoading();
                                var series = [];
                                var legend = [];
                                var j = 0 ;
                                var intent_data =[];                          
                                var my_color = ['rgba(255, 102, 102,0.8)','rgba(102, 204, 204,0.8)'];
                                console.log(my_color[0]);
                                $.get('/static/json/my_json.json', function (data) {

                                data_chart_0 = data[doc_data_str];
                                //get x axis
                                doc_x_str = "DOC_"+dataset_select_detection+"_Xaxis";
                                doc_x_key =  data_chart_0["Intent_Class"][0]+"_xaxis";
                                console.log("first_key: "+doc_x_key);
                                doc_data_chart_x = data[doc_x_str][doc_x_key];
                                console.log("first_key: "+ doc_data_chart_x);

                                length = data_chart_0.Intent_Class.length;
                                console.log("this is length:++++"+length);
                                for(i=0;i<length;i++){
                                    opention_str = data_chart_0.Intent_Class[i];
                                    console.log(opention_str);
                                    $("#select_data").append("<option value="+opention_str+">"+opention_str+"</option>");
                                    form.render('select');
                                }
                                doc_threshold = data_chart_0.Intent_Threshold 

                                doc_content_str = "DOC_"+dataset_select_detection+"_Content";
                                data_chart_1 = data[doc_content_str][data_chart_0.Intent_Class[0]];
                                data_length = data_chart_1.Known_Intent.length-1;
                                console.log(data_length);
                                myChart1.hideLoading();  // 
                                myChart1.clear();//清除缓存
                                //get /static/json/bar_test.json
                                for(var key in data_chart_1){
                                    legend.push(key); 
                                    intent_data.push(data_chart_1[key]);
                                    console.log("threshold_test: "+doc_threshold[0])
                                    series.push({
                                        type:'line',
                                        markLine:{
                                                    symbol:"none",               
                                                    label:{
                                                        position:"end",
                                                        color:'blue',
                                                        fontWeight: 'bolder',
                                                        formatter: function (params) {
                                                        str = "Statistics Threshold: " + (doc_threshold[0]).slice(-3);                                            
                                                        return str
                                                        },          
                                                    },
                                                    
                                                    data : [{
                                                        silent:false,  
                                                        lineStyle:{               
                                                            type:"solid",
                                                            color:'blue',
                                                           
                                                            
                                                        },
                                                        xAxis: doc_threshold[0],
                                                    }]
                                                }
                                    })
                                    series.push({
                                            name: key,
                                            type: 'bar',
                                            color:my_color[j],
                                            barGap: '-100%',//添加此配置项即为重叠效果  被重叠
                                            barCategoryGap: "10%",
                                            data: data_chart_1[key],
                                           
                                        });
                                        j = j+1;
                                        console.log(j);                                       
                                    };                              
                                myChart1.setOption({                                   
                                    tooltip : {
                                    trigger: 'axis',
                                    axisPointer:{
                                        type:'line',
                                        lineStyle:{
                                            color:'blue',
                                            type: 'solid'

                                        }
                                        
                                        // lineStyle:{
                                        //     color:"blue",
                                        //     type:'line',
                                        // }
                                    },
                                    formatter:function(params){                                        
                                        var sumNum_k = 0;
                                        var sumNum_n = 0;
                                        var sumAll = 0;
                                        for(i=0;i<=data_length;i++){ 
                                            sumAll = sumAll + (-intent_data[1][i])+ intent_data[0][i];
                                        };
                                        console.log(data_length);
                                        console.log(sumAll);
                                        for(i=data_length;i>params[0].dataIndex;i--){ 
                                            sumNum_k = sumNum_k + intent_data[0][i];
                                        };
                                        for(i=0;i<params[0].dataIndex;i++){ 
                                            sumNum_n = sumNum_n + (-intent_data[1][i]);
                                        };
                                        score = ((sumNum_k+sumNum_n)/sumAll).toFixed(2);
                                        if(params[0] == undefined & params[1] == undefined){
                                            return false
                                        }else if(params[0] == undefined){
                                            mystr = params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[1].value+"<br>"+'</span>';
                                            return mystr
                                        }else if(params[1] == undefined){
                                            mystr = params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[0].value+"<br>"+'</span>';
                                            return mystr
                                        }else{
                                            console.log("This isnt null----"+(params[0].name-0.05).toFixed(2))
                                            mystr = 'Threshold: '+'<span style="font-weight:800;font-size:13px;">'+((params[0].name))+"<br>"+'</span>'
                                            +params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+sumNum_k+"<br>"+'</span>'
                                            +params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+sumNum_n+"<br>"+'</span>'
                                            +'Score: '+'<span style="font-weight:800;font-size:13px;">'+score+"<br>"+'</span>';
                                            return mystr
                                        }
                                    },
                                    textStyle:{
                                　　align:'left'
                                　　　},
                                    }, 
                                    legend: {
                                        data: legend,
                                    },
                                    
                                    grid: {
                                        left: '5%',
                                        right: '25%',
                                        bottom: '3%',
                                        top:'20%',
                                        containLabel: true
                                    },
                                    //0403
                                    xAxis: {
                                        name:'Confidence Score',
                                        
                                        type: 'category',
                                        data:  doc_data_chart_x,
                                        nameTextStyle:{
                                            fontWeight:550,
                                        },
                                        axisLabel:{
                                            show: true,
                                            rotate:"42",
                                            textStyle:{
                                            fontWeight: 550,
                                            fontSize:12
                                            
                                            
                                        }
                                    },
                                 
                                    },
                                    yAxis: { 
                                        name:'Numbers of Samples',
                                        type: 'value',
                                        boundaryGap: [0, 0.01],
                                        nameTextStyle:{
                                            fontWeight:550,
                                        },
                                        axisLabel:{
                                            show: true,
                                            textStyle:{
                                            fontWeight: 550,
                                            fontSize:12
                                        }
                                    }
                                    },
                                    series: series,
                            })
                            }, 'json');
                    }else if(model_detection == 'OpenMax'){
                         $('#doc').hide();
                        var myChart2 = echarts.init(document.getElementById('image1'));
                            myChart2.hideLoading();
                            var series = [];
                            var legend = [];
                            var i = 0 ;
                            var intent_data =[];                          
                            var my_color = ['rgba(255, 102, 102,0.8)','rgba(102, 204, 204,0.8)','rgba(244, 164,96,0.8)'];
                            console.log(my_color[2])
                             $.get('/static/json/my_json.json', function (data) {
                                data_chart_s = data["OpneMax_Index"]["Score"];
                                data_chart_x = data["OpneMax_Index"]["xaxis"];
                                data_chart_2 = data["OpneMax_Threshold"];
                                data_length = data_chart_2.Known_Intent.length-1;
                                console.log(data_length);
                                myChart2.hideLoading();  // 
                                myChart2.clear();//清除缓存
                                //get /static/json/bar_test.json
                                for(var key in data_chart_2){
                                    legend.push(key); 
                                    intent_data.push(data_chart_2[key]);
                                    series.push({
                                        type:'line',
                                        markLine : {
                                                    symbol:"none",               
                                                    label:{
                                                        position:"end",
                                                        color:'blue',
                                                        fontWeight: 'bolder',
                                                        formatter: function (params) {
                                                        str = "Default Threshold: " + '0.5'                                            
                                                        return str
                                                        },          
                                                    },
                                                    data : [{
                                                        silent:false,  
                                                        lineStyle:{               
                                                            type:"solid",
                                                            color:"blue",
                                                        },
                                                        xAxis:'0.5',
                                                    }]
                                                }
                                    })
                                    series.push({
                                            name: key,
                                            type: 'bar',
                                            color:my_color[i],
                                            barGap: '0%',//添加此配置项即为重叠效果  被重叠
                                            barCategoryGap: "10%",
                                            data: data_chart_2[key],
                                            
                                        });
                                        i = i+1;  
                                        console.log(i)                                     
                                    };
                                myChart2.setOption({                                   
                                    tooltip : {
                                    trigger: 'axis',
                                    axisPointer:{
                                        lineStyle:{
                                            color:"blue",
                                            type:'line',
                                        }
                                    },
                                    formatter:function(params){  
                                        if(params[0] == undefined & params[1] == undefined & params[2] == undefined ){
                                            return false
                                        }else if(params[0] == undefined & params[1] == undefined){
                                            mystr = params[2].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+(-params[2].value)+"<br>"+'</span>';
                                            return mystr
                                        }else if(params[0] == undefined & params[2] == undefined){
                                            mystr = params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+(-params[1].value)+"<br>"+'</span>';
                                            return mystr
                                        }else if(params[1] == undefined & params[2] == undefined){
                                            mystr = params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[0].value+"<br>"+'</span>';
                                            return mystr
                                        }else if(params[0] == undefined){
                                            mystr = params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+(-params[1].value)+"<br>"+'</span>'
                                            +params[2].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+(-params[2].value)+"<br>"+'</span>';
                                            return mystr
                                        }else if(params[1] == undefined){
                                            mystr = params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[0].value+"<br>"+'</span>'
                                            +params[2].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+(-params[2].value)+"<br>"+'</span>';
                                            return mystr
                                        }else if(params[2] == undefined){
                                            mystr = params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[0].value+"<br>"+'</span>'
                                            +params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+(-params[1].value)+"<br>"+'</span>';
                                            return mystr
                                        }
                                        else {
                                            mystr = 'Threshold: '+'<span style="font-weight:800;font-size:13px;">'+params[0].name+"<br>"+'</span>'
                                            +params[0].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+params[0].value+"<br>"+'</span>'
                                            +params[1].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+(-params[1].value)+"<br>"+'</span>'
                                            +params[2].seriesName+": "+'<span style="font-weight:800;font-size:13px;">'+(-params[2].value)+"<br>"+'</span>'
                                            +'Score: '+'<span style="font-weight:800;font-size:13px;">'+data_chart_s[params[0].dataIndex]+"<br>"+'</span>';
                                        return mystr
                                        }
                                        
                                    },
                                    textStyle:{
                                　　align:'left'
                                　　　},
                                    }, 
                                    legend: {
                                        data: legend,
                                    },

                                    grid: {
                                        left: '3%',
                                        right: '4%',
                                        bottom: '3%',
                                        top:'20%',
                                        containLabel: true
                                    },
                                    xAxis: {
                                        //name:'Samples',
                                        type: 'category',
                                        data:  data_chart_x,
                                        nameTextStyle:{
                                            fontWeight:550,
                                        },
                                        axisLabel:{
                                            show: true,
                                            textStyle:{
                                            fontWeight: 550,
                                            fontSize:12
                                        }
                                    }
                                    },
                                    yAxis: { 
                                        //name:'Probability',
                                        type: 'value',
                                        boundaryGap: [0, 0.01],
                                        nameTextStyle:{
                                            fontWeight:550,
                                        },
                                        axisLabel:{
                                            show: true,
                                            textStyle:{
                                            fontWeight: 550,
                                            fontSize:12
                                        }
                                    }
                                    },
                                    series: series,
                            })
                            }, 'json');


                    }
                    }
                    return false;
                });


            });
            

            function collapseTable(options) {
                anotherEvent = {"known":"open","open":"known"}
                var trObj = options.elem;
                if (!trObj) return;
                var accordion = options.accordion,
                success = options.success,
                content = options.content || '';
                event = options.event;
                var tableView = trObj.parents('.layui-table-view'); //当前表格视图
                var id = tableView.attr('lay-id'); //当前表格标识
                var index = trObj.data('index'); //当前行索引
                var leftTr = tableView.find('.layui-table-fixed.layui-table-fixed-l tr[data-index="' + index + '"]'); //左侧当前固定行
                var rightTr = tableView.find('.layui-table-fixed.layui-table-fixed-r tr[data-index="' + index + '"]'); //右侧当前固定行
                var colspan = trObj.find('td').length; //获取合并长度
                var trObjChildren = trObj.next(); //展开行Dom
                var indexChildren = id + '-' + index + '-children'+'-'+event; //展开行索引
                var anotherIndexChildren = id + '-' + index + '-children'+'-'+anotherEvent[event]; //展开行索引
                var leftTrChildren = tableView.find('.layui-table-fixed.layui-table-fixed-l tr[data-index="' + indexChildren + '"]'); //左侧展开固定行
                var rightTrChildren = tableView.find('.layui-table-fixed.layui-table-fixed-r tr[data-index="' + indexChildren + '"]'); //右侧展开固定行
                var lw = leftTr.width() + 15; //左宽
                var rw = rightTr.width() + 15; //右宽

                //不存在就创建展开行
                if (trObjChildren.data('index') != indexChildren ) {
                    //装载HTML元素
                    
                    var tr = '<tr data-index="' + indexChildren + '"><td colspan="' + colspan + '"><div style="height: auto;padding-left:' + lw + 'px;padding-right:' + rw + 'px" class="layui-table-cell">' + content + '</div></td></tr>';
                    trObjChildren = trObj.after(tr).next().hide(); //隐藏展开行
                    var fixTr = '<tr data-index="' + indexChildren + '"></tr>';//固定行
                    leftTrChildren = leftTr.after(fixTr).next().hide(); //左固定
                    rightTrChildren = rightTr.after(fixTr).next().hide(); //右固定
                }
                
                
                //展开|折叠箭头图标
                trObj.find('td[lay-event="'+event+'"] i.layui-colla-icon').toggleClass("layui-icon-right layui-icon-down");
                                
                //显示|隐藏展开行
                trObjChildren.toggle();
                //开启手风琴折叠和折叠箭头
                if (accordion) {
                    // trObj.find('td[lay-event="'+event+'"] i.layui-colla-icon').toggleClass("layui-icon-down layui-icon-right");
                    trObj.siblings().find('td[lay-event="'+event+'"] i.layui-colla-icon').removeClass("layui-icon-down").addClass("layui-icon-right");
                    trObjChildren.siblings('[data-index$="-children"]').hide(); //展开
                    rightTrChildren.siblings('[data-index$="-children"]').hide(); //左固定
                    leftTrChildren.siblings('[data-index$="-children"]').hide(); //右固定
                }
                success(trObjChildren, indexChildren); //回调函数
                heightChildren = trObjChildren.height(); //展开高度固定
                rightTrChildren.height(heightChildren + 115).toggle(); //左固定
                leftTrChildren.height(heightChildren + 115).toggle(); //右固定
            }

            function getOptionsForTextTableOfKnown(trObj, accordion, content, event, dataset_name, class_type, label_name, method){
                if(label_name == "< UNK >"){
                    label_name = "<UNK>"
                }
                console.log('dataset_name:\t'+dataset_name+'\nclass_type:\t'+class_type+'\nlabel_name:\t'+label_name)
                var optionForClassTable = {
                    elem: trObj,
                    accordion: accordion,
                    content: content,
                    event: event,
                    success: function(trObjChildren, index) { //成功回调函数
                        //trObjChildren 展开tr层DOM
                        //index 当前层索引
                        trObjChildren.find('table').attr("id", index);
                        table.render({
                            elem: "#" + index,
                            url: '/detection/model_analysis/model_analysis_getTextListByDatasetNameAndMethodAndLabel',
                            cellMinWidth: 80,
                            page: { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                                layout: ['prev', 'page', 'next' , 'count' ] //自定义分页布局
                                //,curr: 5 //设定初始在第 5 页
                                ,first: 'first'
                                ,last: 'last'
                                
                            },
                            cols: [[ //表头
                                    {field: 'text', title: 'Text' , align: 'left', templet: function(d) {
                                        return "<a style='width:inherit;display:block;white-space:normal;'>"+d.text+"</a>"
                                    }}
                                    ,{field: 'label_name', title: 'True Label' , align: 'center', templet: function(d) {
                                        label_name_tmp = d.label_name;
                                        if (d.label_name == "<UNK>" || d.label_name == "oos"){
                                            label_name_tmp = "< UNK >"
                                        }

                                        return '<div style="position: relative;\n' + '    padding: 0 10px 0 20px;">' + label_name_tmp + '</div>'
                                    }}
                                ]]
                            ,where:{
                                "dataset_name": dataset_name,
                                "method": method,
                                "label_name": label_name
                            }
                        });

                    }
                }
                return optionForClassTable;
            }


            function errorConfirm(errorMsg){
                var baseErr = ': There is no data for this combination ！！！'
                layer.confirm(
                    errorMsg + baseErr,
                    { icon:6, btn:['Confirm'], title:'Attention Please' }
                )
            }


            function initDefalutEcharts(){
                model_detection = layui.jquery('#model_detection').val()
                dataset_select_detection = layui.jquery('#dataset_select_detection').val()
                //image1    Model Detail Analysis
  
                            $('#doc').hide();
                            
                            var myChart4 = echarts.init(document.getElementById('image1'), null, {renderer: 'svg'});
                            myChart4.hideLoading();
                            var series = [];//保存散点
                            var mylegend = [];//legend部分使用
                                                 
                            //get cluster.json
                            layui.jquery.get('/static/jsons/open_intent_detection/ADB_analysis.json', function (data) {
                                //get cluster
                                data_chart_5 = data["points_banking"];
                                myChart4.clear();//清除缓存
                                //循环显示散点
                                //换行显示legend
                                mylegend.push('');
                                var i = 0;
                                color_list2=[
                                '#5470c6','#91cc75','#fac858','#ee6666','#73c0de','#3ba272','#fc8452','#9a60b4','#ea7ccc','#BBFFFF',
                        '#FFDEAD','	#00868B','#66CDAA','#BEBEBE','#00FF7F','#00CD00','#FFFF00','#FFC1C1','#B8860B','#FF8247',
                        '#B22222','#FF4500','#7B68EE','#458B00','#B0C4DE','#CAFF70','#EEE685','#556B2F','#20B2AA','#32CD32',
                        '#8B658B','#BC8F8F','#CD5555','#DEB887','#B22222','#FA8072','#EEE8AA','#EE9A49','#FF69B4','#8B4513',
                        '#EE82EE','#FF8C69','#9932CC','	#CDC9C9','#EED5B7','#CD4F39','#EE4000','#CDC1C5','#FF34B3','#FFE4E1',
                        '#F0FFFF','#EE3A8C','#836FFF','#EE00EE','#473C8B','#FF83FA','#436EEE','#CD69C9','#0000FF','#CD96CD',
                        '#1E90FF','#E066FF','#1874CD','#7A378B','#5CACEE','#9A32CD','#00B2EE','	#7D26CD','#00688B','#AB82FF',
                        '#6CA6CD','#EED2EE','#8DB6CD','#8B7B8B','#B9D3EE','#6C7B8B','#E0FFFF','#00008B','#D1EEEE','#8B008B',
                        '#8B0000','#90EE90','#DCDCDC','#98F5FF','#FFEBCD','#00C5CD','#FFE4B5','#00CDCD','#79CDCD','#76EEC6',
                        '#FFE4E1','#B4EEB4','#696969','#4EEE94','#6495ED','#00FF7F','#7B68EE','#00FF00','#0000FF','#87CEEB',
                        '#458B00','#00CED1','#BCEE68','#00FFFF','#FFF68F','#7FFFD4','#FFEC8B','#2E8B57','#FFFFE0','#98FB98',
                        '#CDCD00','#00FA9A','#EEC900','	#9ACD32','#EEB422','#8FBC8F','#EEDD82','#EEB4B4','#8B6969','#CD5C5C',
                        '#8B4513','#EE6363','#CD853F','#8B3A3A','#F4A460','#CD6839','#B22222','#FFE7BA','#6B8E23','#FFA54F',
                        '#FF7F50','#CD853F','#FF69B4','#8B4513','#FFB6C1','#CD2626','#FF00FF','#BA55D3','#EE9572','#D8BFD8',
                        '#36648B','#9B30FF','#009ACD','#AB82FF','#A4D3EE','#BFEFFF','#8B008B','#FF34B3','#FF8C00','#228B22'

                                ];
                                for (var key in data_chart_5){
                                    
                                    mylegend.push(key);
                                    console.log("0326-1368:"+key)
                                    series.push({
                                        color:color_list2[i],
                                        name:key,
                                        type:'scatter',
                                        data:data_chart_5[key],
                                        itemStyle: {
                                                borderColor: '#555',   
                                            },
                                            tooltip: {
                                                trigger:'item',
                                                formatter:function(params){
                                                    //console.log(params);                                                             
                                                    var dotHtml2 = '<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#666666"></span>'
                                                    mystr ='<span style="font-size:10px;">'+params.seriesName+"</br>"
                                                        +dotHtml2+"Point:"+'</span>' + '<span style="font-weight:800;font-size:14px;">'+"  " +'('+params.data[0]+','+params.data[1]+')'+'</span>'+'<br>'
                                                        +dotHtml2+"Center:"+'</span>' + '<span style="font-weight:800;font-size:14px;">'+"  " +'('+params.data[2]+','+params.data[3]+')'+'</span>'+'<br>'
                                                        +dotHtml2+"Radiu:"+'</span>' + '<span style="font-weight:800;font-size:14px;">'+"  " +params.data[4]+'</span>';
                                                    return mystr;
                                                    //console.log(params);
                                                }                                               
                                        }
                                    });
                                    i = i+1;
                                };
                                myChart4.setOption({
                                        xAxis: {
                                            
                                        },
                                        yAxis: {
                                            
                                        },
                                        legend: { type: 'scroll', top: 30, data: mylegend },
                                     
                                        tooltip: {
                                        },
                                       
                                        
                                        series: series,
                                   
                                    })
                            }, 'json');


            }

            
        </script>
        <script>
            initDefalutEcharts();</script>

        <script>
            
        </script>
    </body>

    

</html>